<link rel="import" href="../../../../packages/polymer/polymer.html">
<link rel="import" href="../../../../packages/core_elements/core_icon.html">
<link rel="import" href="../../../../packages/core_elements/core_selector.html">

<link rel="import" href="../components/grade_input.html">
<link rel="import" href="../components/grade_item.html">
<link rel="import" href="../components/grade_uri.html">
<link rel="import" href="../components/grade_fascia.html">
<link rel="import" href="../components/loading_panel.html">
<link rel="import" href="../components/grade_button.html">

<link rel="import" href="graph_details_summary.html">

<link rel="import" href="endpoints.html">

<polymer-element name="endpoint-graphs" layout vertical> 

  <template>
    
		<style>
		
		  :host [sidebutton] {  padding-left:5px }
		  
       
      :host [fg] /deep/ [onhover-selected] { display: inline }
      
      :host [list] { min-height:200px; padding:5px; overflow-y:auto }
      
      :host [item] { height:20px}
      
      :host [pointer] { cursor:pointer }
      
      
 	</style>

    <template if="{{item!=null}}">
	   
	    <loading-panel loading="{{loading}}" message="saving endpoint">
	   
	      <div>
	        
	        <template if="{{!item.newModel}}">
	        
	           <!--  graph list and button  -->
             <div flex horizontal layout>
             
              <!-- graph list -->
	            <loading-panel list wired rounded relative flex loading="{{item.loadingGraphs}}" message="loading graphs">
	               <div fit style="overflow-y: auto;" spaced>

	                  <core-selector selectedAttribute="fg">
		                 
		                   <template repeat="{{graph in item.model.graphs | sort(graphSorter)}}">
				               
				                 <!-- entry and remove button -->
				                 <graph-details-summary pointer graph={{graph}}></graph-details-summary>
				                
				              </template>
			              
			              </core-selector>
			              
			              </div>
		           
		            </loading-panel>
           
              <!-- refresh -->
              <grade-button sidebutton icon=refresh
                            tooltip=left
                            label="reload graphs" 
                            on-click={{refreshGraphs}} >
              </grade-button>
           
            </div>
             
            <div horizontal layout style="margin-top:30px">
              <div vertical layout flex>
                
                <grade-item>
	                <grade-fascia truncate flex>
	            
										<grade-input fascia-title
										                label="uri" 
										                invalid="{{ newUrlInvalid }}"
										                inputValue="{{ newUrl }}"
										                type="URL">
										</grade-input>
										
										<grade-uri fascia-subtitle value={{K.uri}}></grade-uri>
		               
	                </grade-fascia>
                </grade-item>
	          
	          <grade-item>
								<grade-fascia truncate flex>
								 
						      <grade-input fascia-title
						                      label="label" 
						                      invalid="{{ newLabelInvalid }}"
						                      inputValue="{{ newLabel }}"
						                      >
						      </grade-input>
						      
						      <grade-uri fascia-subtitle value={{K.label}}></grade-uri>
								      
								 </grade-fascia>
								 </grade-item>
              </div>
                
	            <grade-button
	                  sidebutton
	                  action 
	                  disabled?="{{newUrlInvalid || newUrl.isEmpty || newLabelInvalid || newLabel.isEmpty}}"
	                  icon="add" 
	                  on-click={{addGraph}} 
	                  tooltip=left
	                  label="create new graph">
	            </grade-button>
	            
	          </div>
     
	        
	        </template>
	          
	      </div>  
	    </loading-panel>
    </template>
		
  </template> 
</polymer-element>
