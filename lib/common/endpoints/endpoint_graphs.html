<link rel="import" href="../../../../packages/polymer/polymer.html">
<link rel="import" href="../../../../packages/core_elements/core_icon.html">

<link rel="import" href="../components/grade_input.html">
<link rel="import" href="../components/grade_item.html">
<link rel="import" href="../components/grade_fascia.html">
<link rel="import" href="../components/loading_panel.html">
<link rel="import" href="../components/grade_button.html">

<link rel="import" href="endpoints.html">

<polymer-element name="endpoint-graphs" layout vertical> 

  <template>
    
		<style>
		
			grade-input::shadow [multiline] {
        max-height: 150px;
			}
			
			div:not(:hover) [onbuttonhover] {
			  visibility: hidden;
			}  
		
		</style>

    <template if="{{item!=null}}">
	    <loading-panel loading="{{loading}}" message="saving the endpoint">
	   
	      <div style="overflow-y: auto;">
	        
	        <template if="{{!item.newModel}}">
	        
		        <grade-item icon=chevron-right hidden?={{item.model.predefined}}>
			        <div flex horizontal layout>
			         <grade-input flex  style="height: 37px;"
		                           label="new graph ?" 
		                           invalid="{{ newUrlInvalid }}"
		                           inputValue="{{ newUrl  }}"
		                           type="URL"
		                           >
		              </grade-input>
			         <grade-button action 
					         disabled?="{{newUrlInvalid || newUrl.isEmpty}}"
					         icon="add" 
					         label="add endpoint" 
					         on-click={{addGraph}} 
					         tooltip="left" l
					         abel="add graph" 
					         style="padding-left:5px;padding-right:5px;">
			         </grade-button>
			        </div>
		        </grade-item>
	        
		        <grade-item icon=chevron-right>

		          <grade-fascia truncate style="width: 100%">

		            <div fascia-title>
		            
		              <div horizontal layout>
			              <div wired rounded style="min-height:250px;" relative flex>
				              <loading-panel fit loading="{{item.loadingGraphs}}" message="loading the graphs" style="overflow-y:auto;">
				                 <div small-spaced>
							              <template repeat="{{graph in item.model.graphs}}">
							                <div smaller flex horizontal layout>
							                 <div flex><span>{{ graph | start}}</span><span fg>{{ graph | suffix}}</span></div>
							                 <grade-button hidden?={{item.model.predefined}} action onbuttonhover  smallicon tooltip="left" label="remove graph" icon="delete" on-click={{removeGraph}} graph={{graph}}></grade-button>
							                </div>
							              </template>
					                </div>
				              </loading-panel>
			              </div>
		               <grade-button icon="refresh" label="refresh graphs" on-click="{{refreshGraphs}}" style="padding-left:5px;padding-right:5px;"></grade-button>
		             </div>
		              
		            </div>
		                   
		            <div fascia-subtitle><span>{{ graphs_key | start}}</span><span fg bolder>{{ graphs_key | suffix}}</span></div>
		          </grade-fascia>
		            
		        </grade-item>
	        
	        </template>
	          
	      </div>  
	    </loading-panel>
    </template>
		
  </template> 
</polymer-element>
